<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>피드백 편집 - 리더십 진단 관리자</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
    }
    .nav-item {
      transition: all 0.3s ease;
    }
    .nav-item:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    .nav-item.active {
      background-color: rgba(255, 255, 255, 0.2);
      border-left: 4px solid #fff;
    }
    
    /* 모바일 반응형 */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      .sidebar.mobile-open {
        transform: translateX(0);
      }
      .main-content {
        margin-left: 0 !important;
      }
      .mobile-overlay {
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(2px);
      }
    }
    
    /* 탭 스타일 */
    .dimension-tab.active {
      border-color: #3B82F6 !important;
      color: #3B82F6 !important;
    }
    .dimension-tab {
      border-color: transparent !important;
      color: #6B7280 !important;
      transition: all 0.2s ease;
    }
    .dimension-tab:hover {
      color: #374151 !important;
    }
    
    /* 콘텐츠 애니메이션 */
    .dimension-content {
      animation: fadeIn 0.3s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* 2x2 그리드 레이아웃 */
    .feedback-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      height: 80vh;
    }
    
    /* 개별 섹션 스타일 */
    .feedback-section {
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
    }
    
    /* 고정 크기 텍스트 영역 */
    .fixed-textarea {
      resize: none;
      height: 120px;
      flex: 1;
    }
    
    /* 카드 그림자 효과 */
    .card-shadow {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    /* 모바일에서는 1열로 변경 */
    @media (max-width: 768px) {
      .feedback-grid {
        grid-template-columns: 1fr;
        height: auto;
      }
    }
    
    /* 로그 항목 스타일 */
    .log-item {
      border-left: 3px solid #e5e7eb;
      transition: all 0.2s ease;
    }
    .log-item:hover {
      border-left-color: #3b82f6;
      background-color: #f8fafc;
    }
  </style>
</head>
<body class="bg-gray-50">
  
  <!-- Mobile Menu Overlay -->
  <div id="mobileOverlay" class="fixed inset-0 mobile-overlay z-40 hidden md:hidden"></div>
  
  <!-- Navigation Sidebar -->
  <div id="sidebar" class="sidebar fixed inset-y-0 left-0 w-64 bg-gray-800 text-white z-50">
    <div class="p-4 md:p-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-lg md:text-xl font-bold">관리자 대시보드</h1>
          <p class="text-gray-400 text-xs md:text-sm" id="adminWelcome">관리자님 환영합니다</p>
        </div>
        <button id="closeSidebar" class="md:hidden text-white hover:text-gray-300">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
    </div>
    
    <nav class="mt-4 md:mt-8">
      <a href="dashboard.html" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-tachometer-alt mr-3"></i>
        <span class="text-sm md:text-base">대시보드</span>
      </a>
      <a href="participants.html" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-users mr-3"></i>
        <span class="text-sm md:text-base">참여자 관리</span>
      </a>
      <a href="feedback.html" class="nav-item active flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-edit mr-3"></i>
        <span class="text-sm md:text-base">피드백 편집</span>
      </a>
      <a href="admin-management.html" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-user-cog mr-3"></i>
        <span class="text-sm md:text-base">관리자 관리</span>
      </a>
      <a href="#" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white" onclick="logout()">
        <i class="fas fa-sign-out-alt mr-3"></i>
        <span class="text-sm md:text-base">로그아웃</span>
      </a>
    </nav>
  </div>

  <!-- Main Content Area -->
  <div class="main-content ml-0 md:ml-64 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30">
      <div class="px-4 md:px-6 py-3 md:py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <button id="mobileMenuBtn" class="md:hidden mr-3 text-gray-600 hover:text-gray-800">
              <i class="fas fa-bars text-xl"></i>
            </button>
            <h2 class="text-lg md:text-2xl font-semibold text-gray-800">피드백 편집</h2>
          </div>
          <div class="flex items-center space-x-2 md:space-x-4">
            <div class="hidden md:block text-sm text-gray-600" id="currentDateTime"></div>
            <button onclick="resetToDefaults()" class="bg-gray-600 hover:bg-gray-700 text-white px-2 md:px-4 py-1 md:py-2 rounded-lg text-xs md:text-sm">
              <i class="fas fa-undo mr-1"></i>
              <span class="hidden md:inline">기본값</span>
            </button>
            <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-2 md:px-4 py-1 md:py-2 rounded-lg text-xs md:text-sm">
              <i class="fas fa-sign-out-alt mr-1"></i>
              <span class="hidden md:inline">로그아웃</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Content -->
    <div class="p-4 md:p-6">
      
      <!-- Success Message -->
      <div id="successMessage" class="hidden bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4 card-shadow">
        <div class="flex items-center">
          <i class="fas fa-check-circle mr-2"></i>
          <span>피드백이 성공적으로 저장되었습니다!</span>
        </div>
      </div>

      <!-- Introduction -->
      <div class="bg-white rounded-lg shadow-sm p-4 md:p-6 mb-6 card-shadow">
        <h3 class="text-lg font-semibold mb-4">피드백 편집 안내</h3>
        <div class="bg-blue-50 rounded-lg p-4">
          <p class="text-blue-700 text-sm">
            <i class="fas fa-info-circle mr-2"></i>
            여기서 수정한 피드백 내용은 진단 결과 페이지에 실시간으로 반영됩니다. 
            변경사항은 자동으로 저장되며, 모든 새로운 진단 결과에 적용됩니다.
          </p>
        </div>
      </div>

      <!-- 4개 섹션 2x2 그리드 레이아웃 -->
      <div class="bg-white rounded-lg shadow-sm mb-6 card-shadow">
        <div class="p-6">
          <h3 class="text-xl font-semibold mb-6 text-center">다크 트라이어드 피드백 편집</h3>
          
          <div class="feedback-grid">
            <!-- 나르시시즘 섹션 -->
            <div class="feedback-section bg-red-50 border-red-200">
              <h4 class="text-lg font-semibold mb-4 text-red-600 flex items-center">
                <i class="fas fa-crown mr-2"></i>나르시시즘
              </h4>
              
              <form class="flex flex-col space-y-3 flex-1">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">차원 이름</label>
                  <input type="text" id="narcissism_name" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="나르시시즘" value="나르시시즘">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">간단한 설명</label>
                  <input type="text" id="narcissism_shortDesc" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="자기중심적 사고와 우월감" value="자기중심적 사고와 우월감">
                </div>

                <div class="flex-1 flex flex-col">
                  <label class="block text-sm font-medium text-gray-700 mb-1">상세 설명</label>
                  <textarea id="narcissism_description" 
                            class="fixed-textarea w-full px-2 py-1 border border-gray-300 rounded text-sm"
                            placeholder="상세 설명을 입력하세요...">자신에 대한 과도한 자신감과 우월감, 타인의 칭찬과 인정에 대한 강한 욕구를 나타냅니다.</textarea>
                </div>

                <button type="button" onclick="saveDimensionFeedback('narcissism')" 
                        class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded text-sm">
                  <i class="fas fa-save mr-2"></i>나르시시즘 저장
                </button>
              </form>
            </div>

            <!-- 마키아벨리즘 섹션 -->
            <div class="feedback-section bg-orange-50 border-orange-200">
              <h4 class="text-lg font-semibold mb-4 text-orange-600 flex items-center">
                <i class="fas fa-chess mr-2"></i>마키아벨리즘
              </h4>
              
              <form class="flex flex-col space-y-3 flex-1">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">차원 이름</label>
                  <input type="text" id="machiavellianism_name" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="마키아벨리즘" value="마키아벨리즘">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">간단한 설명</label>
                  <input type="text" id="machiavellianism_shortDesc" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="목적을 위한 수단 정당화" value="목적을 위한 수단 정당화">
                </div>

                <div class="flex-1 flex flex-col">
                  <label class="block text-sm font-medium text-gray-700 mb-1">상세 설명</label>
                  <textarea id="machiavellianism_description" 
                            class="fixed-textarea w-full px-2 py-1 border border-gray-300 rounded text-sm"
                            placeholder="상세 설명을 입력하세요...">목표 달성을 위해 수단과 방법을 가리지 않으며, 타인을 조작하거나 이용하는 경향을 나타냅니다.</textarea>
                </div>

                <button type="button" onclick="saveDimensionFeedback('machiavellianism')" 
                        class="w-full bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded text-sm">
                  <i class="fas fa-save mr-2"></i>마키아벨리즘 저장
                </button>
              </form>
            </div>

            <!-- 사이코패시 섹션 -->
            <div class="feedback-section bg-purple-50 border-purple-200">
              <h4 class="text-lg font-semibold mb-4 text-purple-600 flex items-center">
                <i class="fas fa-mask mr-2"></i>사이코패시
              </h4>
              
              <form class="flex flex-col space-y-3 flex-1">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">차원 이름</label>
                  <input type="text" id="psychopathy_name" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="사이코패시" value="사이코패시">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">간단한 설명</label>
                  <input type="text" id="psychopathy_shortDesc" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="감정적 냉담함과 충동성" value="감정적 냉담함과 충동성">
                </div>

                <div class="flex-1 flex flex-col">
                  <label class="block text-sm font-medium text-gray-700 mb-1">상세 설명</label>
                  <textarea id="psychopathy_description" 
                            class="fixed-textarea w-full px-2 py-1 border border-gray-300 rounded text-sm"
                            placeholder="상세 설명을 입력하세요...">타인에 대한 공감 부족, 감정적 냉담함, 그리고 충동적인 행동 경향을 나타냅니다.</textarea>
                </div>

                <button type="button" onclick="saveDimensionFeedback('psychopathy')" 
                        class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded text-sm">
                  <i class="fas fa-save mr-2"></i>사이코패시 저장
                </button>
              </form>
            </div>

            <!-- 종합해석 섹션 -->
            <div class="feedback-section bg-blue-50 border-blue-200">
              <h4 class="text-lg font-semibold mb-4 text-blue-600 flex items-center">
                <i class="fas fa-chart-line mr-2"></i>종합해석
              </h4>
              
              <form class="flex flex-col space-y-3 flex-1">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">매우 낮은 점수 제목</label>
                  <input type="text" id="veryLow_title" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="건강한 리더십 성향" value="건강한 리더십 성향">
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">높은 점수 제목</label>
                  <input type="text" id="high_title" 
                         class="w-full px-2 py-1 border border-gray-300 rounded text-sm"
                         placeholder="개선이 시급한 리더십 성향" value="개선이 시급한 리더십 성향">
                </div>

                <div class="flex-1 flex flex-col">
                  <label class="block text-sm font-medium text-gray-700 mb-1">종합 설명</label>
                  <textarea id="overall_description" 
                            class="fixed-textarea w-full px-2 py-1 border border-gray-300 rounded text-sm"
                            placeholder="종합 해석 설명을 입력하세요...">리더십 다크 트라이어드 진단 결과에 따른 종합적인 해석입니다.</textarea>
                </div>

                <button type="button" onclick="saveOverallInterpretations()" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded text-sm">
                  <i class="fas fa-save mr-2"></i>종합해석 저장
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- 수정 로그 (하단 위치) -->
      <div class="bg-white rounded-lg shadow-sm p-4 md:p-6 card-shadow">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">
            <i class="fas fa-history mr-2 text-gray-600"></i>수정 로그
          </h3>
        </div>
        
        <div id="modificationLogs" class="space-y-2 max-h-60 overflow-y-auto">
          <div class="text-sm text-gray-500 text-center py-4">
            <i class="fas fa-info-circle mr-2"></i>아직 수정 기록이 없습니다.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 전역 변수
    let currentAdmin = null;

    // 페이지 초기화
    document.addEventListener('DOMContentLoaded', function() {
      console.log('피드백 편집 페이지 초기화...');
      
      // 인증 확인
      checkAuth();
      
      // 기본 초기화
      updateDateTime();
      setInterval(updateDateTime, 60000);
      setupMobileMenu();
      
      // 피드백 데이터 로드
      loadFeedbackData();
      loadModificationLogs();
      
      // 실시간 미리보기 설정
      setupRealtimePreview();
    });

    // 인증 확인 함수
    function checkAuth() {
      const savedAdmin = localStorage.getItem('currentAdmin');
      if (!savedAdmin) {
        alert('로그인이 필요합니다.');
        window.location.href = 'index.html';
        return false;
      }
      
      try {
        const admin = JSON.parse(savedAdmin);
        currentAdmin = admin;
        document.getElementById('adminWelcome').textContent = `${admin.name}님 환영합니다`;
        return true;
      } catch (error) {
        console.error('인증 정보 오류:', error);
        window.location.href = 'index.html';
        return false;
      }
    }

    // 모바일 메뉴 설정
    function setupMobileMenu() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('mobileOverlay');
      const closeSidebar = document.getElementById('closeSidebar');

      if (mobileMenuBtn) {
        mobileMenuBtn.addEventListener('click', function() {
          sidebar.classList.add('mobile-open');
          overlay.classList.remove('hidden');
          document.body.style.overflow = 'hidden';
        });
      }

      function closeMobileMenu() {
        sidebar.classList.remove('mobile-open');
        overlay.classList.add('hidden');
        document.body.style.overflow = '';
      }

      if (closeSidebar) closeSidebar.addEventListener('click', closeMobileMenu);
      if (overlay) overlay.addEventListener('click', closeMobileMenu);
    }

    // 실시간 미리보기 설정
    function setupRealtimePreview() {
      const dimensions = ['narcissism', 'machiavellianism', 'psychopathy'];
      const fields = ['name', 'shortDesc', 'description'];
      
      dimensions.forEach(dimension => {
        fields.forEach(field => {
          const element = document.getElementById(`${dimension}_${field}`);
          if (element) {
            element.addEventListener('input', () => {
              markAsChanged(element);
            });
          }
        });
      });

      // 종합 해석 필드
      const overallFields = ['veryLow_title', 'high_title', 'overall_description'];
      overallFields.forEach(fieldId => {
        const element = document.getElementById(fieldId);
        if (element) {
          element.addEventListener('input', () => {
            markAsChanged(element);
          });
        }
      });
    }

    // 변경사항 표시
    function markAsChanged(element) {
      element.dataset.changed = 'true';
      element.style.borderColor = '#f59e0b';
    }

    // 현재 시간 업데이트
    function updateDateTime() {
      const now = new Date();
      const dateTimeString = now.toLocaleString('ko-KR');
      const element = document.getElementById('currentDateTime');
      if (element) {
        element.textContent = dateTimeString;
      }
    }

    // 피드백 데이터 로드
    function loadFeedbackData() {
      const customFeedback = JSON.parse(localStorage.getItem('customFeedback') || '{}');
      
      if (Object.keys(customFeedback).length === 0) {
        initializeDefaultFeedback();
        return;
      }
      
      // 각 차원별 데이터 로드
      loadDimensionFeedbackData('narcissism', customFeedback.narcissism);
      loadDimensionFeedbackData('machiavellianism', customFeedback.machiavellianism);
      loadDimensionFeedbackData('psychopathy', customFeedback.psychopathy);
      loadOverallInterpretationData(customFeedback.overall);
    }

    // 기본 피드백 초기화
    function initializeDefaultFeedback() {
      const defaultFeedback = {
        narcissism: {
          name: "나르시시즘",
          shortDesc: "자기중심적 사고와 우월감",
          description: "자신에 대한 과도한 자신감과 우월감, 타인의 칭찬과 인정에 대한 강한 욕구를 나타냅니다."
        },
        machiavellianism: {
          name: "마키아벨리즘",
          shortDesc: "목적을 위한 수단 정당화",
          description: "목표 달성을 위해 수단과 방법을 가리지 않으며, 타인을 조작하거나 이용하는 경향을 나타냅니다."
        },
        psychopathy: {
          name: "사이코패시",
          shortDesc: "감정적 냉담함과 충동성",
          description: "타인에 대한 공감 부족, 감정적 냉담함, 그리고 충동적인 행동 경향을 나타냅니다."
        },
        overall: {
          veryLow: {
            title: "건강한 리더십 성향",
            description: "매우 건강하고 균형 잡힌 리더십 성향을 보이고 있습니다."
          },
          high: {
            title: "개선이 시급한 리더십 성향",
            description: "리더십에서 잠재적 위험 요소가 높아 즉각적인 개선이 필요합니다."
          }
        }
      };
      
      localStorage.setItem('customFeedback', JSON.stringify(defaultFeedback));
      loadFeedbackData();
    }

    // 차원별 피드백 데이터 로드
    function loadDimensionFeedbackData(dimension, data) {
      if (!data) return;
      
      const nameElement = document.getElementById(`${dimension}_name`);
      const shortDescElement = document.getElementById(`${dimension}_shortDesc`);
      const descriptionElement = document.getElementById(`${dimension}_description`);
      
      if (nameElement) nameElement.value = data.name || '';
      if (shortDescElement) shortDescElement.value = data.shortDesc || '';
      if (descriptionElement) descriptionElement.value = data.description || '';
    }

    // 종합 해석 데이터 로드
    function loadOverallInterpretationData(data) {
      if (!data) return;
      
      const veryLowTitleElement = document.getElementById('veryLow_title');
      const highTitleElement = document.getElementById('high_title');
      const overallDescElement = document.getElementById('overall_description');
      
      if (veryLowTitleElement && data.veryLow) {
        veryLowTitleElement.value = data.veryLow.title || '';
      }
      if (highTitleElement && data.high) {
        highTitleElement.value = data.high.title || '';
      }
      if (overallDescElement) {
        overallDescElement.value = '리더십 다크 트라이어드 진단 결과에 따른 종합적인 해석입니다.';
      }
    }

    // 차원별 피드백 저장
    function saveDimensionFeedback(dimension) {
      const customFeedback = JSON.parse(localStorage.getItem('customFeedback') || '{}');
      
      const feedbackData = {
        name: document.getElementById(`${dimension}_name`).value,
        shortDesc: document.getElementById(`${dimension}_shortDesc`).value,
        description: document.getElementById(`${dimension}_description`).value
      };
      
      customFeedback[dimension] = feedbackData;
      localStorage.setItem('customFeedback', JSON.stringify(customFeedback));
      
      // 수정 로그 추가
      addModificationLog([`${feedbackData.name} 피드백 수정`]);
      
      // 성공 메시지 표시
      showSuccess();
      
      // 변경 표시 제거
      resetChangedStyles(dimension);
    }

    // 종합 해석 저장
    function saveOverallInterpretations() {
      const customFeedback = JSON.parse(localStorage.getItem('customFeedback') || '{}');
      
      const overallData = {
        veryLow: {
          title: document.getElementById('veryLow_title').value,
          description: document.getElementById('overall_description').value
        },
        high: {
          title: document.getElementById('high_title').value,
          description: document.getElementById('overall_description').value
        }
      };
      
      customFeedback.overall = overallData;
      localStorage.setItem('customFeedback', JSON.stringify(customFeedback));
      
      // 수정 로그 추가
      addModificationLog(['종합해석 수정']);
      
      // 성공 메시지 표시
      showSuccess();
      
      // 변경 표시 제거
      resetChangedStyles('overall');
    }

    // 변경 스타일 리셋
    function resetChangedStyles(section) {
      const inputs = document.querySelectorAll(`[id^="${section}_"]`);
      inputs.forEach(input => {
        input.style.borderColor = '#d1d5db';
        input.dataset.changed = 'false';
      });
    }

    // 수정 로그 추가
    function addModificationLog(changedFields) {
      const logs = JSON.parse(localStorage.getItem('feedbackModificationLogs') || '[]');
      
      const adminInfo = currentAdmin || { name: '관리자', id: 'admin' };
      
      const logEntry = {
        id: Date.now(),
        adminName: adminInfo.name,
        adminId: adminInfo.id,
        timestamp: new Date().toISOString(),
        changedFields: changedFields,
        action: '피드백 편집'
      };
      
      logs.unshift(logEntry);
      
      // 최대 50개의 로그만 유지
      if (logs.length > 50) {
        logs.splice(50);
      }
      
      localStorage.setItem('feedbackModificationLogs', JSON.stringify(logs));
      loadModificationLogs();
    }

    // 수정 로그 로드
    function loadModificationLogs() {
      const logs = JSON.parse(localStorage.getItem('feedbackModificationLogs') || '[]');
      const container = document.getElementById('modificationLogs');
      
      if (logs.length === 0) {
        container.innerHTML = `
          <div class="text-sm text-gray-500 text-center py-4">
            <i class="fas fa-info-circle mr-2"></i>아직 수정 기록이 없습니다.
          </div>
        `;
        return;
      }
      
      container.innerHTML = '';
      
      logs.forEach(log => {
        const logItem = document.createElement('div');
        logItem.className = 'log-item bg-white border border-gray-200 rounded-lg p-3 mb-2';
        
        const timeAgo = getTimeAgo(new Date(log.timestamp));
        
        logItem.innerHTML = `
          <div class="flex items-start justify-between">
            <div class="flex-1">
              <div class="flex items-center text-sm">
                <i class="fas fa-user-circle text-gray-400 mr-2"></i>
                <span class="font-medium text-gray-900">${log.adminName}</span>
                <span class="text-gray-500 mx-2">•</span>
                <span class="text-gray-500">${timeAgo}</span>
              </div>
              <div class="mt-1 text-sm text-gray-600">
                <i class="fas fa-edit text-blue-500 mr-1"></i>
                ${log.action}: ${log.changedFields.join(', ')}
              </div>
            </div>
          </div>
        `;
        
        container.appendChild(logItem);
      });
    }

    // 시간 경과 계산
    function getTimeAgo(date) {
      const now = new Date();
      const diffInSeconds = Math.floor((now - date) / 1000);
      
      if (diffInSeconds < 60) {
        return '방금 전';
      } else if (diffInSeconds < 3600) {
        return `${Math.floor(diffInSeconds / 60)}분 전`;
      } else if (diffInSeconds < 86400) {
        return `${Math.floor(diffInSeconds / 3600)}시간 전`;
      } else if (diffInSeconds < 2592000) {
        return `${Math.floor(diffInSeconds / 86400)}일 전`;
      } else {
        return date.toLocaleDateString('ko-KR');
      }
    }

    // 기본값으로 복원
    function resetToDefaults() {
      if (confirm('모든 피드백 내용을 기본값으로 복원하시겠습니까?\n현재 편집 중인 내용이 모두 사라집니다.')) {
        localStorage.removeItem('customFeedback');
        initializeDefaultFeedback();
        
        // 복원 로그 추가
        addModificationLog(['전체 피드백 기본값 복원']);
        
        alert('기본값으로 복원되었습니다.');
      }
    }

    // 성공 메시지 표시
    function showSuccess() {
      const successMessage = document.getElementById('successMessage');
      successMessage.classList.remove('hidden');
      setTimeout(() => {
        successMessage.classList.add('hidden');
      }, 3000);
    }

    // 로그아웃
    function logout() {
      if (confirm('로그아웃 하시겠습니까?')) {
        localStorage.removeItem('currentAdmin');
        window.location.href = 'index.html';
      }
    }
  </script>
</body>
</html>
