<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>피드백 편집 - 리더십 진단 관리자</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
    }
    .nav-item {
      transition: all 0.3s ease;
    }
    .nav-item:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    .nav-item.active {
      background-color: rgba(255, 255, 255, 0.2);
      border-left: 4px solid #fff;
    }
    
    /* 모바일에서 사이드바 숨기기 */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      .sidebar.mobile-open {
        transform: translateX(0);
      }
      .main-content {
        margin-left: 0 !important;
      }
      .mobile-overlay {
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(2px);
      }
    }
    
    /* 텍스트 영역 자동 크기 조절 */
    .auto-resize {
      resize: vertical;
      min-height: 120px;
      max-height: 400px;
    }
    
    /* 카드 그림자 효과 */
    .card-shadow {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: box-shadow 0.3s ease;
    }
    .card-shadow:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
  </style>
</head>
<body class="bg-gray-50">
  
  <!-- Mobile Menu Overlay -->
  <div id="mobileOverlay" class="fixed inset-0 mobile-overlay z-40 hidden md:hidden"></div>
  
  <!-- Navigation Sidebar -->
  <div id="sidebar" class="sidebar fixed inset-y-0 left-0 w-64 bg-gray-800 text-white z-50">
    <div class="p-4 md:p-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-lg md:text-xl font-bold">관리자 대시보드</h1>
          <p class="text-gray-400 text-xs md:text-sm" id="adminWelcome">관리자님 환영합니다</p>
        </div>
        <button id="closeSidebar" class="md:hidden text-white hover:text-gray-300">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
    </div>
    
    <nav class="mt-4 md:mt-8">
      <a href="dashboard.html" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-tachometer-alt mr-3"></i>
        <span class="text-sm md:text-base">대시보드</span>
      </a>
      <a href="participants.html" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-users mr-3"></i>
        <span class="text-sm md:text-base">참여자 관리</span>
      </a>
      <a href="feedback.html" class="nav-item active flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white">
        <i class="fas fa-edit mr-3"></i>
        <span class="text-sm md:text-base">피드백 편집</span>
      </a>
      <a href="#" class="nav-item flex items-center px-4 md:px-6 py-3 text-gray-300 hover:text-white" onclick="logout()">
        <i class="fas fa-sign-out-alt mr-3"></i>
        <span class="text-sm md:text-base">로그아웃</span>
      </a>
    </nav>
  </div>

  <!-- Main Content Area -->
  <div class="main-content ml-0 md:ml-64 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30">
      <div class="px-4 md:px-6 py-3 md:py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <button id="mobileMenuBtn" class="md:hidden mr-3 text-gray-600 hover:text-gray-800">
              <i class="fas fa-bars text-xl"></i>
            </button>
            <h2 class="text-lg md:text-2xl font-semibold text-gray-800">피드백 편집</h2>
          </div>
          <div class="flex items-center space-x-2 md:space-x-4">
            <div class="hidden md:block text-sm text-gray-600" id="currentDateTime"></div>
            <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-2 md:px-4 py-1 md:py-2 rounded-lg text-xs md:text-sm">
              <i class="fas fa-sign-out-alt mr-1"></i>
              <span class="hidden md:inline">로그아웃</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Content -->
    <div class="p-4 md:p-6">
      
      <!-- Success Message -->
      <div id="successMessage" class="hidden bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4 card-shadow">
        <div class="flex items-center">
          <i class="fas fa-check-circle mr-2"></i>
          <span>피드백이 성공적으로 저장되었습니다!</span>
        </div>
      </div>

      <!-- 건강한 리더십 성향 카드 -->
      <div class="bg-white rounded-lg shadow-sm p-4 md:p-6 mb-6 card-shadow">
        <div class="flex items-center mb-4">
          <div class="bg-green-100 p-2 rounded-lg mr-3">
            <i class="fas fa-leaf text-green-600 text-lg md:text-xl"></i>
          </div>
          <h3 class="text-lg md:text-xl font-semibold text-gray-800">건강한 리더십 성향</h3>
        </div>
        
        <div class="bg-green-50 border border-green-200 rounded-lg p-3 md:p-4 mb-4">
          <p class="text-sm md:text-base text-green-800">매우 건강하고 균형 잡힌 리더십 성향을 보이고 있습니다.</p>
        </div>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-bullseye mr-1 text-green-600"></i>강점
            </label>
            <textarea id="healthyStrengths" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                      placeholder="건강한 리더십의 강점을 입력하세요...">정직하고 윤리적인 리더십을 발휘하여 팀원들의 신뢰를 얻고 있습니다. 의사결정 시 타인을 배려하며, 지속적인 자기개발에 집중하고 있습니다.</textarea>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-lightbulb mr-1 text-green-600"></i>권장사항
            </label>
            <textarea id="healthyRecommendations" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                      placeholder="권장사항을 입력하세요...">현재의 균형 잡힌 리더십 스타일을 유지하면서, 지속적인 자기개발에 집중하세요.</textarea>
          </div>
        </div>
      </div>

      <!-- 종합 해석 카드 -->
      <div class="bg-white rounded-lg shadow-sm p-4 md:p-6 mb-6 card-shadow">
        <div class="flex items-center mb-4">
          <div class="bg-blue-100 p-2 rounded-lg mr-3">
            <i class="fas fa-chart-line text-blue-600 text-lg md:text-xl"></i>
          </div>
          <h3 class="text-lg md:text-xl font-semibold text-gray-800">종합 해석</h3>
        </div>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-clipboard-list mr-1 text-blue-600"></i>전체 분석 내용
            </label>
            <textarea id="comprehensiveAnalysis" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      rows="8"
                      placeholder="종합적인 분석 내용을 입력하세요...">이 진단 결과는 귀하의 리더십 성향을 다크 트라이어드(Dark Triad) 관점에서 분석한 것입니다.

다크 트라이어드는 나르시시즘(Narcissism), 마키아벨리즘(Machiavellianism), 사이코패시(Psychopathy) 세 가지 성격 특성을 의미합니다. 이러한 특성들은 적절한 수준에서는 리더십에 도움이 될 수 있지만, 과도할 경우 조직과 개인에게 부정적인 영향을 미칠 수 있습니다.

귀하의 진단 결과에 따르면, 전반적으로 건강하고 균형 잡힌 리더십 성향을 보이고 있습니다. 이는 매우 긍정적인 결과로, 현재의 리더십 스타일을 유지하면서 지속적인 성장을 추구하는 것이 좋겠습니다.

앞으로도 윤리적 리더십과 팀원들과의 신뢰 관계 구축에 지속적으로 노력하시기 바랍니다.</textarea>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-route mr-1 text-blue-600"></i>발전 방향
            </label>
            <textarea id="developmentDirection" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      placeholder="발전 방향을 입력하세요...">1. 현재의 윤리적 리더십 스타일 유지
2. 팀원들과의 소통 강화
3. 지속적인 피드백 수집 및 반영
4. 리더십 역량 개발을 위한 교육 참여
5. 멘토링 및 코칭 활동 참여</textarea>
          </div>
        </div>
      </div>

      <!-- 안정적인 리더십 성향 카드 -->
      <div class="bg-white rounded-lg shadow-sm p-4 md:p-6 mb-6 card-shadow">
        <div class="flex items-center mb-4">
          <div class="bg-purple-100 p-2 rounded-lg mr-3">
            <i class="fas fa-shield-alt text-purple-600 text-lg md:text-xl"></i>
          </div>
          <h3 class="text-lg md:text-xl font-semibold text-gray-800">안정적인 리더십 성향</h3>
        </div>
        
        <div class="bg-purple-50 border border-purple-200 rounded-lg p-3 md:p-4 mb-4">
          <p class="text-sm md:text-base text-purple-800">전반적으로 안정적이고 건강한 리더십 성향을 나타냅니다.</p>
        </div>
        
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-star mr-1 text-purple-600"></i>특징
            </label>
            <textarea id="stableCharacteristics" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                      placeholder="안정적인 리더십의 특징을 입력하세요...">균형잡힌 의사결정 능력과 팀원들에 대한 배려를 보여줍니다. 윤리적 기준을 유지하면서도 목표 달성을 위해 노력하는 모습을 보입니다.</textarea>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              <i class="fas fa-arrow-up mr-1 text-purple-600"></i>개선 방향
            </label>
            <textarea id="stableImprovements" 
                      class="auto-resize w-full px-3 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                      placeholder="개선 방향을 입력하세요...">현재의 긍정적인 리더십 특성을 더욱 발전시키고, 팀의 소통을 더욱 강화하세요.</textarea>
          </div>
        </div>
      </div>

      <!-- 저장 버튼 -->
      <div class="flex flex-col md:flex-row gap-3 md:gap-4">
        <button onclick="saveFeedback()" 
                class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center">
          <i class="fas fa-save mr-2"></i>피드백 저장
        </button>
        <button onclick="previewFeedback()" 
                class="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center">
          <i class="fas fa-eye mr-2"></i>미리보기
        </button>
        <button onclick="resetFeedback()" 
                class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center">
          <i class="fas fa-undo mr-2"></i>초기화
        </button>
      </div>
    </div>
  </div>

  <!-- Preview Modal -->
  <div id="previewModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-4">
    <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-4 md:p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg md:text-xl font-semibold">피드백 미리보기</h3>
          <button onclick="closePreview()" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
        <div id="previewContent" class="space-y-4 text-sm md:text-base">
          <!-- 미리보기 내용이 여기에 표시됩니다 -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // 인증 확인
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof window.AdminAuth !== 'undefined') {
        window.AdminAuth.checkAuth();
      }
      
      updateDateTime();
      setInterval(updateDateTime, 60000);
      loadSavedFeedback();
      setupMobileMenu();
      setupAutoResize();
    });

    // 모바일 메뉴 설정
    function setupMobileMenu() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('mobileOverlay');
      const closeSidebar = document.getElementById('closeSidebar');

      mobileMenuBtn.addEventListener('click', function() {
        sidebar.classList.add('mobile-open');
        overlay.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      });

      function closeMobileMenu() {
        sidebar.classList.remove('mobile-open');
        overlay.classList.add('hidden');
        document.body.style.overflow = '';
      }

      closeSidebar.addEventListener('click', closeMobileMenu);
      overlay.addEventListener('click', closeMobileMenu);
    }

    // 텍스트 영역 자동 크기 조절
    function setupAutoResize() {
      const textareas = document.querySelectorAll('.auto-resize');
      textareas.forEach(textarea => {
        textarea.addEventListener('input', function() {
          this.style.height = 'auto';
          this.style.height = Math.min(this.scrollHeight, 400) + 'px';
        });
        
        // 초기 크기 설정
        textarea.style.height = 'auto';
        textarea.style.height = Math.min(textarea.scrollHeight, 400) + 'px';
      });
    }

    // 현재 시간 업데이트
    function updateDateTime() {
      const now = new Date();
      const dateTimeString = now.toLocaleString('ko-KR');
      const element = document.getElementById('currentDateTime');
      if (element) {
        element.textContent = dateTimeString;
      }
    }

    // 저장된 피드백 불러오기
    function loadSavedFeedback() {
      const savedFeedback = localStorage.getItem('feedbackTemplates');
      if (savedFeedback) {
        const feedback = JSON.parse(savedFeedback);
        document.getElementById('healthyStrengths').value = feedback.healthyStrengths || '';
        document.getElementById('healthyRecommendations').value = feedback.healthyRecommendations || '';
        document.getElementById('comprehensiveAnalysis').value = feedback.comprehensiveAnalysis || '';
        document.getElementById('developmentDirection').value = feedback.developmentDirection || '';
        document.getElementById('stableCharacteristics').value = feedback.stableCharacteristics || '';
        document.getElementById('stableImprovements').value = feedback.stableImprovements || '';
        
        // 텍스트 영역 크기 재조정
        setupAutoResize();
      }
    }

    // 피드백 저장
    function saveFeedback() {
      const feedback = {
        healthyStrengths: document.getElementById('healthyStrengths').value,
        healthyRecommendations: document.getElementById('healthyRecommendations').value,
        comprehensiveAnalysis: document.getElementById('comprehensiveAnalysis').value,
        developmentDirection: document.getElementById('developmentDirection').value,
        stableCharacteristics: document.getElementById('stableCharacteristics').value,
        stableImprovements: document.getElementById('stableImprovements').value,
        lastUpdated: new Date().toISOString()
      };
      
      localStorage.setItem('feedbackTemplates', JSON.stringify(feedback));
      
      // 성공 메시지 표시
      const successMessage = document.getElementById('successMessage');
      successMessage.classList.remove('hidden');
      setTimeout(() => {
        successMessage.classList.add('hidden');
      }, 3000);
    }

    // 피드백 미리보기
    function previewFeedback() {
      const previewContent = document.getElementById('previewContent');
      const healthyStrengths = document.getElementById('healthyStrengths').value;
      const healthyRecommendations = document.getElementById('healthyRecommendations').value;
      const comprehensiveAnalysis = document.getElementById('comprehensiveAnalysis').value;
      const developmentDirection = document.getElementById('developmentDirection').value;
      const stableCharacteristics = document.getElementById('stableCharacteristics').value;
      const stableImprovements = document.getElementById('stableImprovements').value;
      
      previewContent.innerHTML = `
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
          <h4 class="font-semibold text-green-800 mb-2">건강한 리더십 성향</h4>
          <div class="mb-3">
            <strong>강점:</strong>
            <p class="text-gray-700 mt-1">${healthyStrengths || '내용이 없습니다.'}</p>
          </div>
          <div>
            <strong>권장사항:</strong>
            <p class="text-gray-700 mt-1">${healthyRecommendations || '내용이 없습니다.'}</p>
          </div>
        </div>
        
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
          <h4 class="font-semibold text-blue-800 mb-2">종합 해석</h4>
          <div class="mb-3">
            <strong>전체 분석:</strong>
            <p class="text-gray-700 mt-1 whitespace-pre-wrap">${comprehensiveAnalysis || '내용이 없습니다.'}</p>
          </div>
          <div>
            <strong>발전 방향:</strong>
            <p class="text-gray-700 mt-1 whitespace-pre-wrap">${developmentDirection || '내용이 없습니다.'}</p>
          </div>
        </div>
        
        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
          <h4 class="font-semibold text-purple-800 mb-2">안정적인 리더십 성향</h4>
          <div class="mb-3">
            <strong>특징:</strong>
            <p class="text-gray-700 mt-1">${stableCharacteristics || '내용이 없습니다.'}</p>
          </div>
          <div>
            <strong>개선 방향:</strong>
            <p class="text-gray-700 mt-1">${stableImprovements || '내용이 없습니다.'}</p>
          </div>
        </div>
      `;
      
      document.getElementById('previewModal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    // 미리보기 닫기
    function closePreview() {
      document.getElementById('previewModal').classList.add('hidden');
      document.body.style.overflow = '';
    }

    // 피드백 초기화
    function resetFeedback() {
      if (confirm('모든 피드백 내용을 초기화하시겠습니까?')) {
        document.getElementById('healthyStrengths').value = '';
        document.getElementById('healthyRecommendations').value = '';
        document.getElementById('comprehensiveAnalysis').value = '';
        document.getElementById('developmentDirection').value = '';
        document.getElementById('stableCharacteristics').value = '';
        document.getElementById('stableImprovements').value = '';
        
        localStorage.removeItem('feedbackTemplates');
        setupAutoResize();
      }
    }

    // 로그아웃
    function logout() {
      if (confirm('로그아웃 하시겠습니까?')) {
        if (typeof window.AdminAuth !== 'undefined') {
          window.AdminAuth.logout();
        } else {
          window.location.href = 'index.html';
        }
      }
    }
  </script>
</body>
</html>
